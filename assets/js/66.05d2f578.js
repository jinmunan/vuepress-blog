(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{396:function(s,a,t){"use strict";t.r(a);var n=t(3),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("序言")]),s._v(" "),a("p",[s._v("本内容是 MySQL-8.0.25 版本在云服务器的 Linux 系统下的安装步骤，Linux 系统为 CentOS 7，所以也会涉及到 systemctl 关于 MySQL 服务的管理。")])]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#_1、视图的特点"}},[s._v("1、视图的特点")])]),a("li",[a("a",{attrs:{href:"#_2、创建视图"}},[s._v("2、创建视图")])]),a("li",[a("a",{attrs:{href:"#_3、查看视图"}},[s._v("3、查看视图")])]),a("li",[a("a",{attrs:{href:"#_4、视图无法更新"}},[s._v("4、视图无法更新")])]),a("li",[a("a",{attrs:{href:"#_5、修改视图"}},[s._v("5、修改视图")])]),a("li",[a("a",{attrs:{href:"#_6、删除视图"}},[s._v("6、删除视图")])]),a("li",[a("a",{attrs:{href:"#_1、创建存储过程"}},[s._v("1、创建存储过程")])]),a("li",[a("a",{attrs:{href:"#_2、设置新的结束标记"}},[s._v("2、设置新的结束标记")])]),a("li",[a("a",{attrs:{href:"#_3、存储过程调用"}},[s._v("3、存储过程调用")])]),a("li",[a("a",{attrs:{href:"#_4、参数out"}},[s._v("4、参数OUT")])]),a("li",[a("a",{attrs:{href:"#_5、参数in"}},[s._v("5、参数IN")])]),a("li",[a("a",{attrs:{href:"#_6、参数inout"}},[s._v("6、参数INOUT")])]),a("li",[a("a",{attrs:{href:"#_1、创建存储函数"}},[s._v("1、创建存储函数")])]),a("li",[a("a",{attrs:{href:"#_2、调用存储函数"}},[s._v("2、调用存储函数")])]),a("li",[a("a",{attrs:{href:"#_1、系统变量"}},[s._v("1、系统变量")])]),a("li",[a("a",{attrs:{href:"#_2、用户变量"}},[s._v("2、用户变量")]),a("ul",[a("li",[a("a",{attrs:{href:"#_2-1、会话用户变量"}},[s._v("2.1、会话用户变量")])]),a("li",[a("a",{attrs:{href:"#_2-2、局部用户变量"}},[s._v("2.2、局部用户变量")])]),a("li",[a("a",{attrs:{href:"#_2-3、用户变量总结"}},[s._v("2.3、用户变量总结")])])])]),a("li",[a("a",{attrs:{href:"#_1、顺序结构"}},[s._v("1、顺序结构")])]),a("li",[a("a",{attrs:{href:"#_2、分支结构"}},[s._v("2、分支结构")]),a("ul",[a("li",[a("a",{attrs:{href:"#_2-1、if分支"}},[s._v("2.1、IF分支")])]),a("li",[a("a",{attrs:{href:"#_2-2、case分支"}},[s._v("2.2、CASE分支")])])])]),a("li",[a("a",{attrs:{href:"#_3、循环结构"}},[s._v("3、循环结构")]),a("ul",[a("li",[a("a",{attrs:{href:"#_3-1、loop循环"}},[s._v("3.1、LOOP循环")])]),a("li",[a("a",{attrs:{href:"#_3-2、while循环"}},[s._v("3.2、WHILE循环")])]),a("li",[a("a",{attrs:{href:"#_3-3、repeat循环"}},[s._v("3.3、REPEAT循环")])])])]),a("li",[a("a",{attrs:{href:"#_4、跳转语句leave"}},[s._v("4、跳转语句LEAVE")])]),a("li",[a("a",{attrs:{href:"#_5、跳转语句iterate"}},[s._v("5、跳转语句ITERATE")])]),a("li",[a("a",{attrs:{href:"#_1、创建触发器"}},[s._v("1、创建触发器")])]),a("li",[a("a",{attrs:{href:"#_2、删除触发器"}},[s._v("2、删除触发器")])]),a("li",[a("a",{attrs:{href:"#_3、查询触发器"}},[s._v("3、查询触发器")])]),a("li",[a("a",{attrs:{href:"#_1、窗口函数"}},[s._v("1、窗口函数")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1-1、窗口函数示例"}},[s._v("1.1、窗口函数示例")])]),a("li",[a("a",{attrs:{href:"#_1-2、窗口函数分类"}},[s._v("1.2、窗口函数分类")])])])]),a("li",[a("a",{attrs:{href:"#_2、公用表表达式"}},[s._v("2、公用表表达式")]),a("ul",[a("li",[a("a",{attrs:{href:"#_2-1、普通公用表表达式"}},[s._v("2.1、普通公用表表达式")])]),a("li",[a("a",{attrs:{href:"#_2-2、递归公用表表达式"}},[s._v("2.2、递归公用表表达式")])])])])])]),a("p"),s._v(" "),a("h1",{attrs:{id:"mysql高级篇"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql高级篇"}},[s._v("#")]),s._v(" MySQL高级篇")]),s._v(" "),a("blockquote",[a("p",[s._v("数据库对象")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090835668.png",alt:"image-20230110090835668"}})]),s._v(" "),a("h1",{attrs:{id:"一、视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、视图"}},[s._v("#")]),s._v(" 一、视图")]),s._v(" "),a("blockquote",[a("p",[s._v("视图是一个或者多个数据表里的数的逻辑，视图并不存储数据，只是对数据的引用")])]),s._v(" "),a("h2",{attrs:{id:"_1、视图的特点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、视图的特点"}},[s._v("#")]),s._v(" 1、视图的特点")]),s._v(" "),a("ul",[a("li",[s._v("视图是一种虚拟表，本身是不具有数据的，视图建立在已有表的基础上，视图赖以建立的表称为基表")]),s._v(" "),a("li",[s._v("视图的创建和删除与基表无关，视图的数据的增删改与基表有关")]),s._v(" "),a("li",[s._v("视图一般使用在大型项目上，为了简化查询，控制数据的访问")])]),s._v(" "),a("h2",{attrs:{id:"_2、创建视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、创建视图"}},[s._v("#")]),s._v(" 2、创建视图")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CREATE OR REPLACE VIEW test_view (ename) \nAS \nSELECT ename FROM emp;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_3、查看视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、查看视图"}},[s._v("#")]),s._v(" 3、查看视图")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 查看视图信息（显示数据表的存储引擎、版本、数据行数和数据大小等） \nSHOW TABLE STATUS LIKE 'test_view'\n-- 查看视图的详细定义信息\nSHOW CREATE VIEW test_view;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("blockquote",[a("p",[s._v("示例")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 查看视图信息（显示数据表的存储引擎、版本、数据行数和数据大小等） \nSHOW TABLE STATUS LIKE 'vu_emp2';\n-- 查看视图的详细定义信息\nSHOW CREATE VIEW vu_emp2;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"_4、视图无法更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、视图无法更新"}},[s._v("#")]),s._v(" 4、视图无法更新")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("视图存在多种情况导致无法更新")])]),s._v(" "),a("li",[a("p",[s._v("视图主要作用是查询，而不是增删改")])])]),s._v(" "),a("h2",{attrs:{id:"_5、修改视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、修改视图"}},[s._v("#")]),s._v(" 5、修改视图")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ALTER VIEW test_view \nAS\nSELECT * from dept;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_6、删除视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、删除视图"}},[s._v("#")]),s._v(" 6、删除视图")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DROP VIEW IF EXISTS test_view;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h1",{attrs:{id:"二、存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、存储过程"}},[s._v("#")]),s._v(" 二、存储过程")]),s._v(" "),a("blockquote",[a("p",[s._v("存储过程是一组经过预先编译的SQL语句的封装")])]),s._v(" "),a("h2",{attrs:{id:"_1、创建存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建存储过程"}},[s._v("#")]),s._v(" 1、创建存储过程")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_procedure () \nBEGIN\n\tSELECT * FROM emp;\nEND //\nDELIMITER;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"_2、设置新的结束标记"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、设置新的结束标记"}},[s._v("#")]),s._v(" 2、设置新的结束标记")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 设置新的结束标记//\nDELIMITER //\nCREATE PROCEDURE test_procedure () \nBEGIN\n\tSELECT * FROM emp;\nEND //\n-- 重新设置回来原先的结束标签，避免与sql弄混\nDELIMITER;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"_3、存储过程调用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、存储过程调用"}},[s._v("#")]),s._v(" 3、存储过程调用")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("call test_procedure();\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_4、参数out"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、参数out"}},[s._v("#")]),s._v(" 4、参数OUT")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_out ( OUT ms DOUBLE ) \nBEGIN\nSELECT MIN(salary) INTO ms FROM emp;\nEND // \nDELIMITER;\ncall test_out(@ms);\nselect @ms;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"_5、参数in"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、参数in"}},[s._v("#")]),s._v(" 5、参数IN")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_in (IN empname VARCHAR (20)) \nBEGIN\n\tSELECT salary FROM emp WHERE ename = empname;\nEND // \nDELIMITER;\ncall test_in('小白龙');\n-- 定义变量调用\nSET @ename := '小白龙';\nCALL test_in(@ename);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"_6、参数inout"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、参数inout"}},[s._v("#")]),s._v(" 6、参数INOUT")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_inout (INOUT empname VARCHAR (20)) \nBEGIN\n\tSELECT ename INTO empname FROM emp WHERE id = ( SELECT id FROM emp WHERE ename = empname );\nEND // \nDELIMITER;\nset @empname := '小白龙';\ncall test_inout(@empname);\nselect @empname\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h1",{attrs:{id:"三、存储函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、存储函数"}},[s._v("#")]),s._v(" 三、存储函数")]),s._v(" "),a("h2",{attrs:{id:"_1、创建存储函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建存储函数"}},[s._v("#")]),s._v(" 1、创建存储函数")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE FUNCTION test_function () \nRETURNS VARCHAR ( 25 )\nBEGIN\n\tRETURN (SELECT ename FROM emp WHERE id = '1001');\nEND // \nDELIMITER;\nselect test_function();\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"_2、调用存储函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、调用存储函数"}},[s._v("#")]),s._v(" 2、调用存储函数")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SELECT test_function();\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h1",{attrs:{id:"四、变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、变量"}},[s._v("#")]),s._v(" 四、变量")]),s._v(" "),a("blockquote",[a("p",[s._v("变量分为"),a("code",[s._v("系统变量")]),s._v("以及"),a("code",[s._v("用户变量")])])]),s._v(" "),a("h2",{attrs:{id:"_1、系统变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、系统变量"}},[s._v("#")]),s._v(" 1、系统变量")]),s._v(" "),a("blockquote",[a("p",[s._v("系统变量又分为全局变量和会话变量")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 查看所有全局变量 \nSHOW GLOBAL VARIABLES;\n\n-- 查看所有会话变量 \nSHOW SESSION VARIABLES;\n\n-- 查看指定的系统变量\nSELECT @@global.变量名;\n\n-- 查看指定的会话变量\nSELECT @@session.变量名;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"_2、用户变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、用户变量"}},[s._v("#")]),s._v(" 2、用户变量")]),s._v(" "),a("blockquote",[a("p",[s._v("用户变量又分为"),a("code",[s._v("会话用户变量")]),s._v("和"),a("code",[s._v("局部用户变量")])])]),s._v(" "),a("h3",{attrs:{id:"_2-1、会话用户变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、会话用户变量"}},[s._v("#")]),s._v(" 2.1、会话用户变量")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SET @num = 1;\nSET @num := 2;\nSELECT @num := COUNT(*) FROM emp; \nSELECT COUNT(*) into @num FROM emp; \nselect @num\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_2-2、局部用户变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、局部用户变量"}},[s._v("#")]),s._v(" 2.2、局部用户变量")]),s._v(" "),a("blockquote",[a("p",[s._v("使用DECLARE声明在存储过程或存储函数中")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE add_value () \nBEGIN\n\t#局部变量\n\tDECLARE m INT DEFAULT 1;\n\tDECLARE n INT DEFAULT 3;\n\tDECLARE SUM INT;\n\tSET SUM = m + n;\n\tSELECT SUM;\nEND // \nDELIMITER;\nCALL add_value();\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"_2-3、用户变量总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、用户变量总结"}},[s._v("#")]),s._v(" 2.3、用户变量总结")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th"),s._v(" "),a("th",[s._v("作用域")]),s._v(" "),a("th",[s._v("定义位置")]),s._v(" "),a("th",[s._v("语法")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("会话用户变量")]),s._v(" "),a("td",[s._v("当前会话")]),s._v(" "),a("td",[s._v("会话的任何地方")]),s._v(" "),a("td",[s._v("加@符号，不用指定类型")])]),s._v(" "),a("tr",[a("td",[s._v("局部变量")]),s._v(" "),a("td",[s._v("定义它的BEGIN END中")]),s._v(" "),a("td",[s._v("BEGIN END的第一句话")]),s._v(" "),a("td",[s._v("一般不用加@,需要指定类型")])])])]),s._v(" "),a("h1",{attrs:{id:"五、流程控制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、流程控制"}},[s._v("#")]),s._v(" 五、流程控制")]),s._v(" "),a("h2",{attrs:{id:"_1、顺序结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、顺序结构"}},[s._v("#")]),s._v(" 1、顺序结构")]),s._v(" "),a("blockquote",[a("p",[s._v("从上往下依次执行")])]),s._v(" "),a("h2",{attrs:{id:"_2、分支结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、分支结构"}},[s._v("#")]),s._v(" 2、分支结构")]),s._v(" "),a("h3",{attrs:{id:"_2-1、if分支"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、if分支"}},[s._v("#")]),s._v(" 2.1、IF分支")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_if ( IN i INT ) BEGIN\n\tIF i > 0 THEN\n\t\tSELECT  'i > 0';\n    ELSE\n\t\tSELECT 'i <= 0';\n\tEND IF;\nEND // \nDELIMITER;\nCALL test_if (0);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"_2-2、case分支"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、case分支"}},[s._v("#")]),s._v(" 2.2、CASE分支")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 方式一\nDELIMITER //\nCREATE PROCEDURE test_case (in i INT) BEGIN \n    CASE i \n        WHEN 1 THEN\n        SELECT 'val is 1';\n        WHEN 2 THEN\n        SELECT 'val is 2';\n        ELSE \n        SELECT 'val is not 1 or 2';\n    END CASE;\nEND // \nDELIMITER;\nCALL test_case (1);\n\n-- 方式二\nDELIMITER //\nCREATE PROCEDURE test_case2 (in i INT) BEGIN \n    CASE  \n        WHEN i = 1 THEN\n        SELECT 'val is 1';\n        WHEN i = 2 THEN\n        SELECT 'val is 2';\n        ELSE \n        SELECT 'val is not 1 or 2';\n    END CASE;\nEND // \nDELIMITER;\nCALL test_case2 (1);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h2",{attrs:{id:"_3、循环结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、循环结构"}},[s._v("#")]),s._v(" 3、循环结构")]),s._v(" "),a("h3",{attrs:{id:"_3-1、loop循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1、loop循环"}},[s._v("#")]),s._v(" 3.1、LOOP循环")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_loop()\nBEGIN\nDECLARE i INT DEFAULT 1; \n\tloop_label : LOOP \n\t\tSET i = i + 1; \n\t\tIF i >= 10 THEN\n\t\tLEAVE loop_label;\n\t\tEND IF;\n\tEND LOOP loop_label;\nSELECT i;\nEND //\nDELIMITER ;\nCALL test_loop();\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"_3-2、while循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2、while循环"}},[s._v("#")]),s._v(" 3.2、WHILE循环")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_while () BEGIN\nDECLARE i INT DEFAULT 0;\n    WHILE i < 10 \n    DO SET i = i + 1;\n    END WHILE;\nSELECT i;\nEND // \nDELIMITER;\nCALL test_while();\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"_3-3、repeat循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3、repeat循环"}},[s._v("#")]),s._v(" 3.3、REPEAT循环")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_repeat () BEGIN \nDECLARE i INT DEFAULT 0; \n\n    REPEAT \n        SET i = i + 1; \n        UNTIL i >= 10 \n    END REPEAT;\n\nSELECT i;\n\t\nEND // \nDELIMITER;\nCALL test_repeat ();\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"_4、跳转语句leave"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、跳转语句leave"}},[s._v("#")]),s._v(" 4、跳转语句LEAVE")]),s._v(" "),a("blockquote",[a("p",[s._v("break")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DELIMITER //\nCREATE PROCEDURE test_leave (IN num INT) \nbegin_label : BEGIN\n\tIF num <= 0 THEN\n\t\t\tLEAVE begin_label;\n\tELSEIF num = 1 THEN\n\t\tSELECT AVG( salary ) FROM emp;\n\tELSEIF num = 2 THEN\n\t\tSELECT MIN( salary ) FROM emp;\n\tELSE \n\t  SELECT MAX( salary ) FROM emp;\n\tEND IF;\n\tSELECT COUNT(*) FROM emp;\nEND // \nDELIMITER;\ncall test_leave(0);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h2",{attrs:{id:"_5、跳转语句iterate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、跳转语句iterate"}},[s._v("#")]),s._v(" 5、跳转语句ITERATE")]),s._v(" "),a("blockquote",[a("p",[s._v("continue")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\nDELIMITER //\nCREATE PROCEDURE test_iterate()\nBEGIN\n\tDECLARE num INT DEFAULT 0;\n\tloop_label:LOOP\n\t\tSET num = num + 1;\n\t\tIF num < 10 \n\t\t\tTHEN ITERATE loop_label; \n\t\tELSEIF num > 15 \n\t\t\tTHEN LEAVE loop_label;\n\t\tEND IF;\n\t\tSELECT '1';\n\tEND LOOP;\nEND // \nDELIMITER;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h1",{attrs:{id:"六、游标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、游标"}},[s._v("#")]),s._v(" 六、游标")]),s._v(" "),a("blockquote",[a("p",[s._v("游标就是操作查询出来的结果集的数据")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 函数的功能可以实现累加薪资最高的几个员工的薪资值，直到薪资总和达到limit_total_salary参数的值，返回累加的人数给total_count\nDELIMITER //\nCREATE PROCEDURE test_cursor ( IN limit_total_salary DOUBLE, OUT total_count INT ) \nBEGIN\n\tDECLARE\n\t\tsum_salary DOUBLE DEFAULT 0;#记录累加的总工资\n\tDECLARE\n\t\tcursor_salary DOUBLE DEFAULT 0;#记录某一个工资值\n\tDECLARE\n\t\temp_count INT DEFAULT 0;#记录循环个数 \n\t#定义游标\n\tDECLARE\n\t\temp_cursor CURSOR FOR SELECT salary FROM emp ORDER BY salary DESC;\n\t\t#打开游标\n\tOPEN emp_cursor;\n\tREPEAT\n\t\t#使用游标（从游标中获取数据）\n\t\tFETCH emp_cursor INTO cursor_salary;\n\t\tSET sum_salary = sum_salary + cursor_salary;\n\t\tSET emp_count = emp_count + 1;\n\t\tUNTIL sum_salary >= limit_total_salary \n\tEND REPEAT;\n\n\tSET total_count = emp_count;\n\t#关闭游标\n\tCLOSE emp_cursor;\n\nEND // \nDELIMITER;\ncall test_cursor(110000,@total_count);\nSELECT @total_count;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("h1",{attrs:{id:"七、触发器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七、触发器"}},[s._v("#")]),s._v(" 七、触发器")]),s._v(" "),a("blockquote",[a("p",[s._v("和事务相关，比如手动修改数据时，修改某条数据会自动触发触发器，修改另一条相关的数据，保证事务的完整性")])]),s._v(" "),a("h2",{attrs:{id:"_1、创建触发器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建触发器"}},[s._v("#")]),s._v(" 1、创建触发器")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CREATE TABLE test_trigger ( id INT PRIMARY KEY AUTO_INCREMENT, t_note VARCHAR ( 30 ) );\nCREATE TABLE test_trigger_log ( id INT PRIMARY KEY AUTO_INCREMENT, t_log VARCHAR ( 30 ) );\n-- 每当插入表test_trigger时，向test_trigger_log插入一条触发器\nDELIMITER //\nCREATE TRIGGER test_trigger \nBEFORE INSERT ON test_trigger \nFOR EACH ROW\nBEGIN\n\tINSERT INTO test_trigger_log ( t_log ) VALUES ( 'before_insert' );\nEND //\nDELIMITER;\n\ninsert into test_trigger (t_note) values ('触发器')\nselect * from test_trigger_log\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"_2、删除触发器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、删除触发器"}},[s._v("#")]),s._v(" 2、删除触发器")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DROP TRIGGER IF EXISTS test_trigger;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_3、查询触发器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、查询触发器"}},[s._v("#")]),s._v(" 3、查询触发器")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SELECT * FROM information_schema.TRIGGERS;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h1",{attrs:{id:"八、mysql8-0新特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#八、mysql8-0新特性"}},[s._v("#")]),s._v(" 八、MySQL8.0新特性")]),s._v(" "),a("h2",{attrs:{id:"_1、窗口函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、窗口函数"}},[s._v("#")]),s._v(" 1、窗口函数")]),s._v(" "),a("blockquote",[a("p",[s._v("窗口函数类似于分组函数，但仍然展示全部数据")]),s._v(" "),a("p",[s._v("语法：窗口函数() OVER (PARTITION BY 要分组的字段名 ORDER BY 升序还是降序)")]),s._v(" "),a("ul",[a("li",[s._v("OVER表示窗口函数的范围")]),s._v(" "),a("li",[s._v("PARTITION BY表示要分组的字段")])])]),s._v(" "),a("h3",{attrs:{id:"_1-1、窗口函数示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、窗口函数示例"}},[s._v("#")]),s._v(" 1.1、窗口函数示例")]),s._v(" "),a("blockquote",[a("p",[s._v("MySQL5.7做法")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 在计算这个网站在每个城市的销售总额、在全国的销售总额、每个区的销售额占所在城市销售额中的比率，以及占总销售额中的比率\nCREATE TABLE sales ( \n    id INT PRIMARY KEY AUTO_INCREMENT,\n    city VARCHAR ( 15 ), \n    county VARCHAR ( 15 ), \n    sales_value DECIMAL \n);\n\nINSERT INTO sales ( city, county, sales_value )\nVALUES\n\t( '北京', '海淀', 10.00 ),\n\t( '北京', '朝阳', 20.00 ),\n\t( '上海', '黄埔', 30.00 ),\n\t( '上海', '长宁', 10.00 );\n\t\n-- 创建临时表\nCREATE TEMPORARY TABLE a \n-- 计算总计金额\nSELECT SUM( sales_value ) AS sales_value FROM sales;\n\n-- 创建临时表\nCREATE TEMPORARY TABLE b \n-- 计算城市销售合计\nSELECT city,SUM( sales_value ) AS sales_value FROM sales GROUP BY city;\n\n-- 最终计算\nSELECT\n\ts.city AS 城市,\n\ts.county AS 区,\n\ts.sales_value AS 区销售额,\n\tb.sales_value AS 市销售额,\n\ts.sales_value / b.sales_value AS 市比率,\n\ta.sales_value AS 总销售额,\n\ts.sales_value / a.sales_value AS 总比率 \nFROM\n\tsales s\n\tJOIN b ON ( s.city = b.city ) -- 连接市统计结果临时表\n\tJOIN a -- 连接总计金额临时表\nORDER BY\n\ts.city,\n\ts.county;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("blockquote",[a("p",[s._v("MySQL8.0做法")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SELECT\n\tcity AS 城市,\n\tcounty AS 区,\n\tsales_value AS 区销售额,\n\tSUM( sales_value ) OVER ( PARTITION BY city ) AS 市销售额,-- 计算市销售额\n\tsales_value / SUM( sales_value ) OVER ( PARTITION BY city ) AS 市比率,\n\tSUM( sales_value ) OVER () AS 总销售额,-- 计算总销售额\n\tsales_value / SUM( sales_value ) OVER () AS 总比率 \nFROM\n\tsales \nORDER BY\n\tcity,\n\tcounty;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"_1-2、窗口函数分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、窗口函数分类"}},[s._v("#")]),s._v(" 1.2、窗口函数分类")]),s._v(" "),a("img",{staticStyle:{zoom:"200%"},attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20220524155237785.png",alt:"image-20220524155237785"}}),s._v(" "),a("blockquote",[a("p",[s._v("数据准备 在线MySQL8.0测试网页https://dbfiddle.uk/?rdbms=MySQL_8.0&fiddle=36e2a6ab7d5067d67a769cb1519233ce")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CREATE TABLE goods (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    category_id INT,\n    category VARCHAR ( 15 ),\n    NAME VARCHAR ( 30 ),\n    price DECIMAL ( 10, 2 ),\n    stock INT,\n    upper_time DATETIME \n);\nINSERT INTO goods ( category_id, category, NAME, price, stock, upper_time )\nVALUES\n\t( 1, '女装/女士精品', 'T恤', 39.90, 1000, '2020-11-10 00:00:00' ),\n\t( 1, '女装/女士精品', '连衣裙', 79.90, 2500, '2020-11-10 00:00:00' ),\n\t( 1, '女装/女士精品', '卫衣', 89.90, 1500, '2020-11-10 00:00:00' ),\n\t( 1, '女装/女士精品', '牛仔裤', 89.90, 3500, '2020-11-10 00:00:00' ),\n\t( 1, '女装/女士精品', '百褶裙', 29.90, 500, '2020-11-10 00:00:00' ),\n\t( 1, '女装/女士精品', '呢绒外套', 399.90, 1200, '2020-11-10 00:00:00' ),\n\t( 2, '户外运动', '自行车', 399.90, 1000, '2020-11-10 00:00:00' ),\n\t( 2, '户外运动', '山地自行车', 1399.90, 2500, '2020-11-10 00:00:00' ),\n\t( 2, '户外运动', '登山杖', 59.90, 1500, '2020-11-10 00:00:00' ),\n\t( 2, '户外运动', '骑行装备', 399.90, 3500, '2020-11-10 00:00:00' ),\n\t( 2, '户外运动', '运动外套', 799.90, 500, '2020-11-10 00:00:00' ),\n\t( 2, '户外运动', '滑板', 499.90, 1200, '2020-11-10 00:00:00' );\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20220524160047932.png",alt:"image-20220524160047932"}})]),s._v(" "),a("blockquote",[a("p",[s._v("ROW_NUMBER()")]),s._v(" "),a("p",[s._v("ROW_NUMBER()函数能够对数据中的序号进行顺序显示")]),s._v(" "),a("p",[s._v("举例：查询 goods 数据表中每个商品分类下价格降序排列的各个商品信息")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090612353.png",alt:"image-20230110090612353"}})]),s._v(" "),a("blockquote",[a("p",[s._v("RANK()")]),s._v(" "),a("p",[s._v("使用RANK()函数能够对序号进行并列排序，并且会跳过重复的序号，比如序号为1、1、3")]),s._v(" "),a("p",[s._v("举例：使用RANK()函数获取 goods 数据表中各类别的价格从高到低排序的各商品信息")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090628835.png",alt:"image-20230110090628835"}})]),s._v(" "),a("blockquote",[a("p",[s._v("DENSE_RANK()")]),s._v(" "),a("p",[s._v("DENSE_RANK()函数对序号进行并列排序，并且不会跳过重复的序号，比如序号为1、1、2")]),s._v(" "),a("p",[s._v("举例：使用DENSE_RANK()函数获取 goods 数据表中各类别的价格从高到低排序的各商品信息")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090650497.png",alt:"image-20230110090650497"}})]),s._v(" "),a("blockquote",[a("p",[s._v("PERCENT_RANK()")]),s._v(" "),a("p",[s._v("PERCENT_RANK()函数是等级值百分比函数。按照如下方式进行计算")]),s._v(" "),a("p",[s._v("其中，rank的值为使用RANK()函数产生的序号，rows的值为当前窗口的总记录数")]),s._v(" "),a("p",[s._v("举例：计算 goods 数据表中名称为“女装/女士精品”的类别下的商品的PERCENT_RANK值")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090659585.png",alt:"image-20230110090659585"}})]),s._v(" "),a("blockquote",[a("p",[s._v("CUME_DIST()")]),s._v(" "),a("p",[s._v("CUME_DIST()函数主要用于查询小于或等于某个值的比例")]),s._v(" "),a("p",[s._v("举例：查询goods数据表中小于或等于当前价格的比例")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090708882.png",alt:"image-20230110090708882"}})]),s._v(" "),a("blockquote",[a("p",[s._v("LAG(expr，n)")]),s._v(" "),a("p",[s._v("LAG(expr,n)函数返回当前行的前n行的expr的值")]),s._v(" "),a("p",[s._v("举例：查询goods数据表中前一个商品价格与当前商品价格的差值")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090718940.png",alt:"image-20230110090718940"}})]),s._v(" "),a("blockquote",[a("p",[s._v("LEAD(expr，n)")]),s._v(" "),a("p",[s._v("LEAD(expr,n)函数返回当前行的后n行的expr的值")]),s._v(" "),a("p",[s._v("举例：查询goods数据表中后一个商品价格与当前商品价格的差值")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090727270.png",alt:"image-20230110090727270"}})]),s._v(" "),a("blockquote",[a("p",[s._v("FIRST_VALUE(expr)")]),s._v(" "),a("p",[s._v("FIRST_VALUE(expr)函数返回第一个expr的值")]),s._v(" "),a("p",[s._v("举例：按照价格排序，查询第1个商品的价格信息")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090737941.png",alt:"image-20230110090737941"}})]),s._v(" "),a("blockquote",[a("p",[s._v("LAST_VALUE(expr)")]),s._v(" "),a("p",[s._v("LAST_VALUE(expr)函数返回最后一个expr的值")]),s._v(" "),a("p",[s._v("举例：按照价格排序，查询最后一个商品的价格信息")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090744872.png",alt:"image-20230110090744872"}})]),s._v(" "),a("blockquote",[a("p",[s._v("NTH_VALUE(expr,n)")]),s._v(" "),a("p",[s._v("NTH_VALUE(expr,n)函数返回第n个expr的值")]),s._v(" "),a("p",[s._v("举例：查询goods数据表中排名第2和第3的价格信息")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090752341.png",alt:"image-20230110090752341"}})]),s._v(" "),a("blockquote",[a("p",[s._v("NTHLE(n)")]),s._v(" "),a("p",[s._v("NTILE(n)函数将分区中的有序数据分为n个桶，记录桶编号")]),s._v(" "),a("p",[s._v("举例：将goods表中的商品按照价格分为3组")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/jinmunan/imgs@master/MySQL/image-20230110090759389.png",alt:"image-20230110090759389"}})]),s._v(" "),a("h2",{attrs:{id:"_2、公用表表达式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、公用表表达式"}},[s._v("#")]),s._v(" 2、公用表表达式")]),s._v(" "),a("blockquote",[a("p",[s._v("公用表(CTE)可以理解成一个可以复用的子查询")]),s._v(" "),a("p",[s._v("以后再说吧 看也看不懂 累了")])]),s._v(" "),a("h3",{attrs:{id:"_2-1、普通公用表表达式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、普通公用表表达式"}},[s._v("#")]),s._v(" 2.1、普通公用表表达式")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("WITH CTE名称 AS （子查询） SELECT|DELETE|UPDATE 语句;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_2-2、递归公用表表达式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、递归公用表表达式"}},[s._v("#")]),s._v(" 2.2、递归公用表表达式")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("WITH RECURSIVE CTE名称 AS （子查询） SELECT|DELETE|UPDATE 语句;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);